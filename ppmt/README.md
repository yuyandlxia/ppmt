# 泡泡玛特微信小程序抢购脚本

## 项目简介

这是一个基于Hamibot控件操作API的微信小程序泡泡玛特抢购脚本，能够自动化完成商品搜索、选择、购买和支付流程。

## 功能特性

- ✅ 自动打开微信小程序
- ✅ 自动搜索泡泡玛特商品
- ✅ 自动选择商品规格
- ✅ 自动添加到购物车/立即购买
- ✅ 自动确认订单
- ✅ 自动处理支付流程
- ✅ 详细的错误日志记录
- ✅ 重试机制
- ✅ 可配置参数

## 文件结构

```
ppmt/
├── popmart_grabber.js    # 主脚本文件
├── config.json          # 配置文件
└── README.md           # 使用说明
```

## 使用前准备

### 1. 环境要求
- Android设备（建议Android 7.0以上）
- 已安装Hamibot应用
- 已安装微信应用
- 网络连接正常

### 2. 权限设置
- 无障碍服务权限
- 悬浮窗权限
- 存储权限

### 3. 微信准备
- 微信已登录
- 已搜索并收藏泡泡玛特小程序
- 已设置好收货地址
- 已绑定支付方式（微信支付/支付宝/银行卡）

## 安装步骤

### 1. 安装Hamibot
1. 从官网下载Hamibot应用
2. 安装并打开应用
3. 注册/登录账号

### 2. 导入脚本
1. 在Hamibot中点击"新建脚本"
2. 将`popmart_grabber.js`的内容复制粘贴到编辑器中
3. 保存脚本

### 3. 配置参数
1. 根据需要修改`config.json`中的参数
2. 主要配置项：
   - `product_keywords`: 商品搜索关键词
   - `wait_times`: 各种等待时间
   - `max_retry`: 最大重试次数
   - `ui_selectors`: UI元素选择器

## 使用方法

### 1. 启动脚本
1. 打开Hamibot应用
2. 找到并点击"泡泡玛特抢购脚本"
3. 点击"运行"按钮

### 2. 脚本执行流程
```
启动脚本 → 检查环境 → 打开微信 → 搜索小程序 → 进入商品页 → 选择规格 → 购买商品 → 确认订单 → 完成支付
```

### 3. 监控执行
- 脚本运行时会显示详细的日志信息
- 可以通过悬浮窗查看当前执行状态
- 错误信息会以红色文字显示

## 配置说明

### 基础配置
```json
{
  "script_config": {
    "product_keywords": ["泡泡玛特", "POP MART", "盲盒"],
    "wait_times": {
      "short": 1000,
      "medium": 2000,
      "long": 5000,
      "very_long": 10000
    },
    "max_retry": 3
  }
}
```

### UI选择器配置
```json
{
  "ui_selectors": {
    "wechat_selectors": ["微信", "com.tencent.mm:id/icon"],
    "search_selectors": ["搜索", "查找"],
    "product_selectors": ["商品", "详情", "购买"],
    "cart_selectors": ["加入购物车", "加购"],
    "buy_selectors": ["立即购买", "购买"],
    "confirm_selectors": ["确认订单", "提交订单"],
    "payment_methods": ["微信支付", "支付宝"]
  }
}
```

## 常见问题

### Q1: 脚本无法找到微信应用
**A:** 确保微信已安装且可正常打开，检查无障碍服务是否已启用。

### Q2: 无法搜索到泡泡玛特小程序
**A:** 手动在微信中搜索并收藏泡泡玛特小程序，确保小程序名称正确。

### Q3: 商品选择失败
**A:** 检查商品是否还有库存，或者调整`product_selectors`配置。

### Q4: 支付失败
**A:** 确保已绑定支付方式，检查网络连接，或者手动完成支付。

### Q5: 脚本运行速度慢
**A:** 可以适当减少`wait_times`中的等待时间，但要注意不要设置太短导致操作失败。

## 错误处理

### 错误日志级别
- **INFO**: 一般信息，蓝色显示
- **WARN**: 警告信息，黄色显示
- **ERROR**: 错误信息，红色显示

### 常见错误及解决方案

| 错误类型 | 可能原因 | 解决方案 |
|---------|---------|---------|
| 无法打开微信 | 微信未安装或无障碍服务未启用 | 检查微信安装和权限设置 |
| 搜索失败 | 网络问题或小程序名称错误 | 检查网络连接和小程序名称 |
| 商品选择失败 | 商品无库存或UI变化 | 检查商品状态或更新选择器 |
| 支付失败 | 支付方式未绑定或网络问题 | 检查支付设置和网络连接 |

## 安全注意事项

1. **账号安全**: 脚本会操作您的微信账号，请确保在安全环境下使用
2. **支付安全**: 脚本会进行支付操作，请确保支付环境安全
3. **个人信息**: 脚本可能需要访问您的个人信息，请谨慎使用
4. **合规使用**: 请遵守相关法律法规和平台规则

## 免责声明

- 本脚本仅供学习和研究使用
- 使用者需自行承担使用风险
- 开发者不对使用本脚本造成的任何损失负责
- 请遵守相关法律法规和平台规则

## 技术支持

如果遇到问题，请：
1. 查看错误日志信息
2. 检查配置参数是否正确
3. 确认环境设置是否完整
4. 参考常见问题解决方案

## 更新日志

### v1.0 (2024-01-01)
- 初始版本发布
- 支持基础抢购功能
- 添加错误日志记录
- 支持配置参数调整

## 许可证

本项目仅供学习和研究使用，请勿用于商业用途。 